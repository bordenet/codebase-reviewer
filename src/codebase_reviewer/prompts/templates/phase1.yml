# Phase 1: Architecture Analysis Prompt Templates
# These templates define prompts for validating documented architecture against actual code

prompts:
  - id: "1.1"
    title: "Validate Documented Architecture Against Actual Code"
    objective: "Verify if actual code structure matches documented architecture claims"
    tasks:
      - "Compare claimed architectural pattern vs actual implementation"
      - "Verify documented modules/layers exist in code"
      - "Check if technology stack matches documentation"
      - "Identify undocumented components or services"
      - "Flag any significant documentation inaccuracies"
      - "Assess overall architecture quality and appropriateness"
    deliverable: |
      **Architecture Validation Report with Actionable Recommendations**

      ## Claimed vs. Actual Architecture
      - **Claimed Pattern**: [e.g., microservices, monolith, layered]
      - **Actual Pattern**: [What the code actually implements]
      - **Match Status**: âœ… Match / âš ï¸ Partial / âŒ Mismatch

      ## Component Validation
      For each claimed component:
      - **Component Name**: [From documentation]
      - **Status**: âœ… Found / âŒ Missing / âš ï¸ Partial
      - **Location**: [Actual file/directory path]
      - **Discrepancies**: [Any differences from documentation]

      ## Technology Stack Validation
      - **Claimed Technologies**: [List from docs]
      - **Actual Technologies**: [List from code analysis]
      - **Missing**: [Technologies claimed but not found]
      - **Undocumented**: [Technologies used but not documented]

      ## Action Items

      ### ðŸ”´ CRITICAL: Document Actual Architecture Pattern
      **Action**: Create accurate architecture documentation with diagrams
      **Priority**: CRITICAL - Foundation for all other documentation
      **Effort**: 4-6 hours

      **Step 1**: Create architecture overview document
      ```bash
      mkdir -p docs/architecture
      cat > docs/architecture/overview.md << 'EOF'
      # Architecture Overview

      ## Pattern
      [Actual pattern: microservices/monolith/layered/etc.]

      ## Components
      - **Component A**: [Responsibility]
      - **Component B**: [Responsibility]

      ## Data Flow
      [Describe how data flows through the system]
      EOF
      ```

      **Step 2**: Create Mermaid architecture diagram
      ```markdown
      # File: docs/architecture/diagram.md

      ```mermaid
      graph TD
          A[API Layer] --> B[Business Logic]
          B --> C[Data Access]
          C --> D[(Database)]
          A --> E[External Services]
      ```
      ```

      **Step 3**: Validate diagram matches code
      ```bash
      # Verify each component exists
      find . -type d -name "api" -o -name "business" -o -name "data"

      # Check imports match diagram
      grep -r "from.*import" src/ | grep -E "api|business|data"
      ```

      **Success Criteria**:
      - [ ] Architecture document created
      - [ ] Mermaid diagram accurately represents code
      - [ ] All components documented with responsibilities
      - [ ] Data flow documented

      ### ðŸ”´ CRITICAL: Update Component Documentation
      **Action**: Document all actual components and update README
      **Priority**: CRITICAL - Prevents confusion for new developers
      **Effort**: 2-3 hours

      **Step 1**: Create component catalog
      ```bash
      cat > docs/components/catalog.md << 'EOF'
      # Component Catalog

      ## Core Components

      ### DocumentationAnalyzer
      - **Location**: `src/analyzers/documentation.py`
      - **Purpose**: Analyzes README and documentation files
      - **Dependencies**: None
      - **Status**: âœ… Implemented

      ### [Add other components]
      EOF
      ```

      **Step 2**: Update README with accurate component list
      ```markdown
      # Update README.md

      ## Architecture

      This project uses a [pattern] architecture with the following components:

      - **Component A** (`src/component_a/`): [Purpose]
      - **Component B** (`src/component_b/`): [Purpose]

      See [docs/architecture/overview.md](docs/architecture/overview.md) for details.
      ```

      **Success Criteria**:
      - [ ] All components documented
      - [ ] README updated with accurate architecture
      - [ ] Component locations specified
      - [ ] Dependencies mapped

      ### ðŸŸ  HIGH: Fix Technology Stack Documentation
      **Action**: Update documentation to reflect actual technologies used
      **Priority**: HIGH - Prevents setup issues
      **Effort**: 1-2 hours

      **Step 1**: Audit actual dependencies
      ```bash
      # Python
      pip freeze > requirements_actual.txt
      diff requirements.txt requirements_actual.txt

      # Node.js
      npm list --depth=0

      # Check actual imports
      find . -name "*.py" | xargs grep "^import\|^from" | cut -d: -f2 | sort -u > actual_imports.txt
      ```

      **Step 2**: Update README technology section
      ```markdown
      ## Technology Stack

      ### Core Technologies
      - **Python**: 3.11+ (actual version used)
      - **Framework**: Flask 2.3.0 (not FastAPI as previously documented)
      - **Database**: PostgreSQL 15

      ### Key Libraries
      - `requests`: HTTP client
      - `pydantic`: Data validation
      - `pytest`: Testing framework
      ```

      **Success Criteria**:
      - [ ] All technologies documented accurately
      - [ ] Versions specified
      - [ ] Undocumented technologies added
      - [ ] Unused technologies removed

      ## Verification Commands
      ```bash
      # Validate architecture documentation
      python -m codebase_reviewer validate-architecture .

      # Generate component diagram
      python -m codebase_reviewer generate-component-diagram .

      # Check documentation accuracy
      python -m codebase_reviewer check-docs-accuracy .
      ```

      ## Priority Summary
      - ðŸ”´ **CRITICAL**: Architecture docs (4-6h), Component docs (2-3h) - **This week**
      - ðŸŸ  **HIGH**: Tech stack docs (1-2h) - **This sprint**

      **Total Effort**: ~7-11 hours
    ai_model_hints:
      complexity: "high"
      requires_code_analysis: true
    dependencies:
      - "0.1"
      - "0.2"
    context_requirements:
      - "claimed_architecture"
      - "actual_structure"
      - "validation_results"

  - id: "1.2"
    title: "Dependency Analysis and Health Check"
    objective: "Analyze project dependencies for health, security, and documentation accuracy"
    tasks:
      - "Review all external dependencies and their purposes"
      - "Identify any outdated or deprecated dependencies"
      - "Check for potential security concerns"
      - "Verify dependencies match documented prerequisites"
      - "Identify missing dependency documentation"
      - "Assess dependency management practices"
    deliverable: "Dependency health report with recommendations for updates or documentation"
    ai_model_hints:
      complexity: "medium"
    dependencies:
      - "0.3"
    context_requirements:
      - "dependencies"
      - "total_count"
      - "documented_prerequisites"
    conditional: "has_dependencies"
